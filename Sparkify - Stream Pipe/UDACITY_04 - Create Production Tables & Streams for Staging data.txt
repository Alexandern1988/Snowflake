// Create Dimention Tables
CREATE OR REPLACE TABLE UDACITY.PRODUCTION.DIM_USERS (
    USER_ID INT PRIMARY KEY,
    FIRST_NAME VARCHAR,
    LAST_NAME VARCHAR,
    GENDER VARCHAR(1),
    LEVEL VARCHAR 
);

CREATE OR REPLACE TABLE UDACITY.PRODUCTION.DIM_SONGS (
    SONG_ID VARCHAR PRIMARY KEY,
    TITLE VARCHAR,
    ARTIST_ID VARCHAR,
    YEAR INT,
    DURATION NUMERIC
);

CREATE OR REPLACE TABLE UDACITY.PRODUCTION.DIM_ARTISTS (
    ARTIST_ID VARCHAR PRIMARY KEY,
    ARTIST_NAME VARCHAR,
    LOCATION VARCHAR,
    LATITUDE NUMERIC,
    LONGITUDE NUMERIC
);

CREATE OR REPLACE TABLE UDACITY.PRODUCTION.DIM_TIME (
    START_TIME TIMESTAMP PRIMARY KEY,
    HOUR INT,
    DAY INT,
    WEEK INT,
    MONTH INT,
    YEAR INT,
    WEEKDAY VARCHAR
);

// Create Fact Table
CREATE OR REPLACE TABLE UDACITY.PRODUCTION.FACT_SONGPLAYS (
    SONGPLAY_ID INT PRIMARY KEY,
    START_TIME BIGINT,
    USER_ID INT,
    LEVEL VARCHAR,
    SONG_ID VARCHAR,
    ARTIST_ID VARCHAR,
    SESSION_ID INT,
    LOCATION VARCHAR,
    USER_AGENT VARCHAR
);


// Create streams for each table

// Dimentions streams
CREATE OR REPLACE STREAM UDACITY.STAGING.DIM_USERS_STREAM   ON TABLE UDACITY.STAGING.LOG_DATA;
CREATE OR REPLACE STREAM UDACITY.STAGING.DIM_SONGS_STREAM   ON TABLE UDACITY.STAGING.SONG_DATA;
CREATE OR REPLACE STREAM UDACITY.STAGING.DIM_ARTISTS_STREAM ON TABLE UDACITY.STAGING.SONG_DATA;
CREATE OR REPLACE STREAM UDACITY.STAGING.DIM_TIME_STREAM    ON TABLE UDACITY.STAGING.LOG_DATA;

// Select
SELECT * FROM UDACITY.STAGING.DIM_USERS_STREAM;  
SELECT * FROM UDACITY.STAGING.DIM_SONGS_STREAM;  
SELECT * FROM UDACITY.STAGING.DIM_ARTISTS_STREAM;
SELECT * FROM UDACITY.STAGING.DIM_TIME_STREAM;   

// Fact streams
CREATE OR REPLACE STREAM UDACITY.STAGING.SD_SONGPLAYS_STREAM ON TABLE UDACITY.STAGING.SONG_DATA;
CREATE OR REPLACE STREAM UDACITY.STAGING.LD_SONGPLAYS_STREAM ON TABLE UDACITY.STAGING.LOG_DATA;

SELECT * FROM UDACITY.STAGING.SD_SONGPLAYS_STREAM;
SELECT * FROM UDACITY.STAGING.LD_SONGPLAYS_STREAM;





